<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <link rel="stylesheet" href="style.css">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Trabajo UT7 SSF</title>
    </head>
    <body>
        <!-- header -->
        <header>
            <h1>
                TRABAJO FINAL
                <br>
                SISTEMAS INFORMÁTICOS
            </h1>
        </header>
        <!-- Intro -->
        <div class="div_intro">
            <p>
                En esta página web hay una serie de tutoriales para la puesta en marcha de un servidor web en un sistema Ubuntu Server,
                que va desde la <strong>instalación</strong> de los diversos programas (SSH, FTP, Apache2, MySQL, Soporte para PHP) hasta la <strong>securización</strong>
                de estos. El grupo se ha organizado haciendo uso de las metedologías ágiles desde la web de <a href="https://tree.taiga.io/" target="_blank"><strong>TAIGA</strong></a>
                donde se ha creado un Scrum con diferentes sprints con sus respectivas tareas a realizar. Además, se ha utilizado GitHub para el control de versiones de
                esta nuestra página web tutorial.
            </p>
            <h3>
                Herramientas utilizadas para el desarrollo de la actividad:
            </h3>
            <div class="contenedor_logos">
                <div class="taiga_icono">
                    <a href="https://tree.taiga.io/" target="_blank">
                        <img src="Recursos/LOGOS/taiga_logo.png" alt="logo de taiga io">
                    </a>
                </div>
                <div class="github_logo">
                    <a href="https://github.com/Aco097/TrabajoUT7" target="_blank">
                        <img src="Recursos/LOGOS/github_icono.png" alt="logo de github">
                    </a>
                </div>
            </div>
            <br>
            <h3>
                Programas utilizados:
            </h3>
            <div class="contenedor_logos">
                <div class="virtualbox_logo">
                    <a href="https://www.virtualbox.org/wiki/Downloads" target="_blank">
                        <img src="Recursos/LOGOS/Virtualbox_logo.png" alt="logo de virtual box">
                    </a>
                </div>
                <div class="ubuntu_logo">
                    <a href="https://ubuntu.com/download/server" target="_blank">
                        <img src="Recursos/LOGOS/ubuntu-logo.png" alt="logo de ubuntu">
                    </a>
                </div>
                <div class="filezilla_logo">
                    <a href="https://filezilla-project.org/" target="_blank">
                        <img src="Recursos/LOGOS/filezilla_logo.png" alt="logo de filezilla">
                    </a>
                </div>
            </div>
        </div>
        <!-- Indice -->
        <nav>
            <h3 style="color: var(--morado);">
                Indice
            </h3>
            <h3>
                Puesta a punto del servidor
            </h3>
            <ul class="id">
                <li>
                    <a href="#raid1">Configuración particionamiento RAID 1</a>
                </li>
                <li>
                    <a href="#servidor_ssh">Servidor SSH</a>
                </li>
                <li>
                    <a href="#servidor_FTP">Servidor FTP</a>
                </li>
                <li>
                    <a href="#servidor_apache2">Servidor Web Apache2</a>
                </li>
                <li>
                    <a href="#soporte_mysql">Soporte MySQL</a>
                </li>
                <li>
                    <a href="#soporte_php">Soporte PHP</a>
                </li>
            </ul>
            <h3 style="color: var(--morado)">¡Hora de securizar!</h3>
            <ul>
                <li>
                    <a href="#securizar_ssh">Securizando SSH</a>
                </li>
                <li>
                    <a href="#securizar_ftp">Securizando FTP</a>
                </li>
                <li>
                    <a href="#securizar_apache2">Securizando Servidor Web Apache2</a>
                </li>
            </ul>
        </nav>
        <!-- RAID1 -->
        <section id="raid1">
            <h3>
                Configuración particionamiento RAID 1
            </h3>
            <div class="tutorial_raid1">
                <p>
                    Un requisito para la realización de este ejercicio es la utilización de particionamiento RAID 1.
                    Esta configuración, llamada también “mirroring”, es una de las más usadas.
                </p>
                <p>
                    Lo que estamos consiguiendo con este tipo de particionamiento es crear un almacén con información duplicada en dos discos duros.
                    Cuando almacenamos un dato, este se duplica inmediatamente en su unidad espejo para así tener dos veces el mismo dato almacenado.
                </p>
                <img src="Recursos/RAID%201/esquema_raid1.png" alt="esquema de una particion RAID 1">
                <p>
                    Para poder realizar esto en nuestro servidor ubuntu, primero debemos crear el segundo disco duro en la misma máquina virtual:
                </p>
                <img src="Recursos/RAID%201/añadir_discos_duros.png" alt="añadir discos duros" width="500">
                <p>
                    Nos dirigimos a la configuración de la máquina y nos dirigimos a la ventana de “almacenamiento” y hacemos clic en “añadir disco duro”.
                </p>
                <img src="Recursos/RAID%201/icono_crear_discoduro.png" alt="icono de crear discos duros">
                <p>
                    Le daremos al icono de “crear”. Esto nos permitirá crear un nuevo disco duro.
                </p>
                <p>
                    Creamos dicho como siempre hemos estado haciendo en las demás actividades. Le daremos la misma capacidad (25 GB)
                    y será un disco duro dinámico; también crearemos otro de 10 GB. En la siguiente imagen veremos todos los discos duros.
                </p>
                <img src="Recursos/RAID%201/discos_duros_creados.png" alt="imagen donde se ven esos discos duros creados" width="500">
                <p>
                    Con ambos discos duros listos, procederemos a instalar el servidor y configurar dicha partición como RAID 1.
                </p>
                <p>
                    Tras avanzar entre las configuraciones previas, nos detendremos concretamente en este apartado.
                </p>
                <img src="Recursos/RAID%201/custom_storage_layout.png" alt="seleccion del disco duro" width="500">
                <p>
                    Aquí, seleccionamos <strong>“custom storage layout”</strong> donde podremos crear particiones,
                    seleccionar el disco donde queramos instalar el sistema operativo y, lo que nos importa, configurar una partición RAID 1.
                </p>
                <p>
                    Como podemos observar, podemos ver los tres discos duros disponibles para el servidor. Seleccionamos el de 10GB, pues este es el que ha
                    sido creado específicamente para esta tarea.
                </p>
                <p>
                    Le damos a enter en el apartado que pone <strong>“espacio disponible”</strong>.
                    Le daremos a <strong>“add GPT partition”</strong>. Esta opción crea una partición en dicho disco que usaremos como partición RAID 1.
                </p>
                <img src="Recursos/RAID%201/add_gpt_partition.png" alt="añadir particion gpt">
                <br>
                <img src="Recursos/RAID%201/dar_formato_gpt_partition.png" alt="dar formato gpt a la particion">
                <p>
                    Size será el tamaño máximo disponible (9.998GB), el formato ext4 y mount será el sistema (/). Una vez configurado, le damos a
                    <strong>“crear”</strong>.
                </p>
                <img src="Recursos/RAID%201/opción_raid1.png" alt="opcion del menu raid1">
                <p>
                    Ahora, daremos enter en <strong>“create software RAID (md)”</strong>
                </p>
                <img src="Recursos/RAID%201/software_raid1.png" alt="">
                <p>
                    Le dejaremos el mismo nombre (md0). RAID Level será el nivel 1, tal y como nos pide el ejercicio, y activamos los dos dispositivos
                    (los dos discos duros).
                </p>
                <p>
                    Debemos tener en cuenta que para poder configurar este tipo de partición debemos tener 2 dispositivos activos.
                    <strong style="color: red !important;">Si no marcamos ambos, nos saltará un error. Ahora sí, le damos a “crear”</strong>.
                </p>
                <p>
                    Para ponerlo a punto y listo, debemos hacer que en esta se monte y funcione como el <strong>“/home”</strong> del sistema.
                     Para ello, seleccionamos la partición RAID 1 y luego le daremos enter a <strong>“add GPT Partition”</strong>.
                </p>
                <img src="Recursos/RAID%201/md0_partition.png" alt="">
                <p>
                    Cambiaremos el mount y lo pondremos a <strong>“/home”</strong>.
                </p>
                <img src="Recursos/RAID%201/directorio_home.png" alt="">
                <br>
                <img src="Recursos/RAID%201/resumen_montaje.png" alt="">
                <p>
                    En este resumen podremos ver ambas particiones. Donde hemos configurado el RAID 1 y la partición para el disco local.
                </p>
                <p>
                    Al darle a aceptar nos saltará este mensaje de advertencia donde nos dirá que se van a formatear los  diferentes discos.
                    Le daremos a <strong>“continuar”</strong>.
                </p>
                <img src="Recursos/RAID%201/formateo_discos.png" alt="">
            </div>
        </section>
        <!-- Servidor SSH -->
        <section id="servidor_ssh">
            <h3>
                Servidor SSH
            </h3>
            <img src="Recursos/LOGOS/ssh_logo.png" alt="logo ssh">
            <div class="tutorial_ssh">
                <p>
                    Durante la instalación del servidor, Linux Ubuntu nos facilita la instalación por defecto de un servidor SSH. 
                    Obviamente, accederemos a que lo instale de manera predeterminada.
                </p>
                <img src="Recursos/SERVIDOR%20SSH/instalacion_ssh.png" alt="">
                <p>
                    Cuando terminemos de instalar el sistema operativo ubuntu server usaremos el comando para verificar que el SSH está instalado y 
                    operativo usando el comando <strong>“systemctl status ssh”</strong> .
                </p>
                <img src="Recursos/SERVIDOR%20SSH/status_ssh_primero.png" alt="">
                <p>
                    Ahora, tenemos que asignarle una IP a este servidor SSH. Sabremos la IP de nuestra máquina haciendo uso del comando <strong>“ip a”</strong>.
                </p>
                <img src="Recursos/SERVIDOR%20SSH/ssh_ip_a.png" alt="">
                <p>
                    Luego, usamos el comando <strong>“ssh [nombre_usuario]@ip”</strong>. 
                </p>
                <img src="Recursos/SERVIDOR%20SSH/conexion_a_ssh.png" alt="">
                <p>
                    Podemos probar si nos podemos conectar desde otra máquina remota haciendo uso del comando 
                    <strong>“ssh [nombre_usuario]@[ip_máquinaremota] -p [puerto]”</strong>. Por defecto es el puerto 22, pero como más adelante
                    <a href="#securizar_ssh">(click para ir al tutorial)</a> en este trabajo hemos cambiado el puerto por seguridad <strong>(42069)</strong> pondremos esta secuencia de 
                    números.
                </p>
                <img src="Recursos/SERVIDOR%20SSH/ssh_con_puerto.png" alt="">
            </div>
        </section>
        <!-- Servidor FTP -->
        <section id="servidor_FTP">
            <h3>
                Servidor FTP
            </h3>
            <img src="Recursos/LOGOS/ftp-icon.png" alt="logo ftp">
            <div class="tutorial_ftp">
                <p>
                    Para instalar el servidor FTP hacemos uso del comando <strong>“sudo apt install vsftpd”</strong>. 
                </p>
                <img src="Recursos/SERVIDOR%20FTP/instalacion_ftp.png" alt="">
                <p>
                    Para comprobar el estado y asegurarnos que está instalado y activo usamos el comando <strong>“systemctl status vsftpd”</strong>.
                </p>
                <img src="Recursos/SERVIDOR%20FTP/status_ftp_instalacion.png" alt="">
                <p>
                    Tras hacer seguro el servidor FTP  <a href="#securizar_ftp" target="_blank">(click para ir al tutorial)</a> vamos a acceder a este de la siguiente manera. 
                    Primero tenemos que ver la ip de nuestro servidor, para ello usaremos el comando <strong>“ip a”</strong> que nos mostrará la información que deseamos.
                </p>
                <img src="Recursos/SERVIDOR%20FTP/ftp_ip_a.png" alt="ftp ip">
                <p>
                    Esta ip la usaremos para conectarnos al servidor FTP desde el programa FileZilla 
                    <a href="https://filezilla-project.org/">(haz click aquí para descargar FileZilla)</a>. Una vez el programa abierto, le daremos al icono de 
                    <strong>“Abrir el Gestor de Sitios”</strong>.
                </p>
                <img src="Recursos/SERVIDOR%20FTP/filezilla_gestor.png" alt="icono de gestor de sitio del filezilla">
                <p>
                    Crearemos un nuevo sitio. En la pestaña de general, el cual se habilitará para la edición una vez generemos un nuevo sitio, cual llamaremos “Trabajo UT7 SSF”, 
                    debemos poner la IP de nuestro servidor, además del usuario y contraseña (que son los mismos que usamos para conectarnos vía SSH).
                </p>
                <img src="Recursos/SERVIDOR%20FTP/filezilla_nuevo_sitio.png" alt="parametros filezilla" height="294">
                <img src="Recursos/SERVIDOR%20FTP/usuarion_contraseña.png" alt="usuario y contraseña filezilla" width="570">
                <img src="Recursos/SERVIDOR%20FTP/server_desconocido.png" alt="mensaje de advertencia de servidor desconocido" width="570">
                <p>
                    Al terminar de poner los datos, daremos clic en aceptar y se nos abrirá una ventana nueva preguntando que si confiamos en dicho servidor. 
                    Daremos clic y…
                </p>
                <img src="Recursos/SERVIDOR%20FTP/FILEZILLA_CONECTADO_LETSGO.png" alt="FileZilla conectado" width="555">
                <p>
                    Si todo está bien, nos aparecerá el archivo de datos de nuestro servidor ubuntu server. Si es así, enhorabuena: 
                    <strong style="color: var(--dorado)">¡Estás conectado!</strong>
                </p>
            </div>
        </section>
        <!-- Servidor Web Apache2 -->
        <section id="servidor_apache2">
            <h3>
                Servidor web Apache2
            </h3>
            <img src="Recursos/LOGOS/apache_logo.png" alt="logo apache">
            <div class="tutorial_apache2">
                <p>
                    Para instalar el servidor web Apache haremos uso del comando <strong>“sudo apt install apache2”</strong>.
                </p>
                <img src="Recursos/SERVIDOR%20WEB%20APACHE%202/instalar_apache2.png" alt="instalacion apache2" width="750">
                <img src="Recursos/SERVIDOR%20WEB%20APACHE%202/progreso_apache2.png" alt="barra de progrecion de instalacion" width="750">
                <p>
                    Instalado, es ritual comprobar el estado y asegurarnos que está activo. Usamos el comando <strong>“systemctl status apache2”</strong>.
                </p>
                <img src="Recursos/SERVIDOR%20WEB%20APACHE%202/estatus_apache2.png" alt="estado apache2">
                <p>
                    Abriremos el fichero de configuración (no sin antes realizar una copia de seguridad del archivo original): 
                    <strong>“sudo cp /etc/apache2/ports.conf /etc/apache2/ports.conf.original”</strong>.
                    <br style="margin: 10px;">
                    Copia hecha, vamos a cambiar la configuración para permitir que el servidor Apache2 escuche el tráfico web en otros puertos que no sean los puertos 
                    web estándar, debemos agregar una nueva declaración que contenga el nuevo puerto para futuros enlaces. Para ello, usamos el comando: 
                    <strong>“sudo vi /etc/apache2/ports.conf”</strong>.
                </p>
                <p>
                    Configuraremos el servidor Apache para escuchar las conexiones de nuestro puerto 42069.
                </p>
                <img src="Recursos/SERVIDOR%20WEB%20APACHE%202/configuracion_puerto_apache2.png" alt="configuracion puerto apache2">
                <p style="color: red; font-size: 0.85em; text-align: center;">
                    ¡Tener el mismo puerto en el SSH y en el Apache2 puede generar conflicto, por tanto se ha cambiado ha posteriore debido a la aparición de dicho
                    error!
                </p>
                <p>
                    Ahora reiniciamos el servicio apache2 con el siguiente comando: <strong>“sudo service apache2 restart” </strong>
                    y comprobamos el estado por si funciona correctamente.
                </p>
                <img src="Recursos/SERVIDOR%20WEB%20APACHE%202/status_apache2.png" alt="estado del servidor apache2 tras puertos">
                <p>
                    Ahora, si todo está correcto, en el navegador de nuestra máquina cliente, si ingresamos en el buscador la ip del servidor y el puerto que hemos 
                    puesto nos aparecerá la página de Apache2 que nos indica que todo funciona correctamente.
                </p>
                <img src="Recursos/SERVIDOR%20WEB%20APACHE%202/apache2_finalizado.png" alt="pagina web estandar de apache2" width="500">
                <!-- Aqui va nuestra web y los pasos a seguir para conseguirlo -->
                <h4>
                    Nuestra web alojada en el servidor apache2
                </h4>
            </div>
        </section>

        <!-- Soporte MySQL -->
        <section id="soporte_mysql">
            <h3>
                Soporte MySQL
            </h3>
            <img src="Recursos/LOGOS/mysql_logo_icon_169941.png" alt="logo mysql">
            <div class="tutorial_mysql">
                <p>
                    Con un servidor web funcional, deberá instalar un sistema de base de datos para poder almacenar y gestionar los datos. 
                    Para instalar, hacemos uso del comando <strong>“sudo apt install mysql-server”</strong>.
                </p>
                <img src="Recursos/MySQL/install_mysql.png" alt="instalación del mysql">
                <p>
                    Una vez instalado, es recomendable ejecutar una secuencia de comandos de seguridad que viene preinstalada en MySQL, con esta secuencia de comandos 
                    se eliminarán algunos ajustes predeterminados poco seguros y se bloqueará el acceso a su sistema de base de datos.
                </p>
                <p>
                    Iniciemos la siguiente de comandos: <strong>“sudo mysql_secure_installation”</strong>.
                </p>
                <img src="Recursos/MySQL/secure_installation.png" alt="instalacion de seguridad mysql">
                <p>
                    Se nos abrirá lo siguiente. Donde nos preguntará si deseamos configurar el “VALIDATE PASSWORD PLUGIN”. Si se habilita esta característica, 
                    MySQL rechazará con un mensaje de error las contraseñas que no coincidan con los criterios especificados. Dejar la validación desactivada será 
                    una opción segura, pero siempre deberá usar contraseñas seguras y únicas.
                </p>
                <img src="Recursos/MySQL/validate_password.png" alt="validacion de contraseña">
                <p>
                    Si respondemos “y”, se le solicitará que seleccione un nivel de validación de contraseña. Si ingresa “2” para indicar el nivel más seguro, 
                    recibirá un mensaje de error al intentar cualquier contraseña que no contenga números, letras en mayúsculas y minúsculas, caracteres especiales,
                    o que se base en palabras comunes. 
                </p>
                <img src="Recursos/MySQL/niveles_de_seguridad_sql.png" alt="niveles de seguridad para la contraseña mysql">
                <p>
                    Independientemente, su servidor le solicitará que seleccione y confirme una contraseña para el root user de MySQL 
                    <strong style="color: red;">(que nada tiene que ver con el root del sistema, ojo)</strong>.
                </p>
                <p>
                    Introducida una contraseña en base al nivel que haya seleccionado, se le indicará la seguridad de esta y se le preguntará si desea continuar usándola.
                </p>
                <img src="Recursos/MySQL/estimated_strength.png" alt="nivel de seguridad de la contraseña" width="750">
                <p>
                    Establezcamos conexión con el servidor de MySQL como root user de la base de datos administrativa, lo que se infiere del uso cuando se ejecuta este comando 
                    <strong>“sudo mysql”</strong>. Observe que no nos pide la contraseña que hemos introducido pues al usar <strong>“sudo”</strong> estamos haciendo 
                    que MySQL se ejecute ya con esos privilegios.
                </p>
                <img src="Recursos/MySQL/sudo_mysql.png" alt="copyright mysql">
                <p>
                    Para salir de la consola de MySQL escribimos: <strong>"exit"</strong>.
                </p>
                <img src="Recursos/MySQL/bye.png" alt="mensaje de despedida mysql">
            </div>
        </section>

        <!-- Soporte PHP -->
        <section id="soporte_php">
            <h3>
                Soporte PHP
            </h3>
            <img src="Recursos/LOGOS/logo_php.png" alt="logo php">
            <div class="tutorial_php">
                <p>
                    Apache presenta el contenido, MySQL almacena y gestiona los datos. 
                    PHP es el componente de nuestra configuración que procesa el código para mostrar contenido dinámico al usuario final.
                </p>
                <p>
                    Además del paquete <strong>“php”</strong>, se necesitará <strong>“php-mysql”</strong>, un módulo PHP que permite que este se comunique 
                    con bases de datos basadas en MySQL. También se necesitará <strong>“libreapache2-mod-php”</strong> para habilitar Apache para gestionar archivos PHP.
                </p>
                <p style="text-align: center; text-decoration: underline; font-size: 1.25em; color: var(--dorado)">
                    ¡Instalemos esos paquetes!
                </p>
                <p>
                    Ejecutamos lo siguiente en la consola de comandos: <strong>“sudo apt install php libapache2-mod-php php-mysql”</strong>.
                </p>
                <img src="Recursos/PHP/instalacion_php.png" alt="instalacion php">
                <p>
                    Una vez la instalación se complete, ejecutaremos el siguiente comando para ver la versión de PHP: <strong>“php -v”</strong>.
                </p>
                <img src="Recursos/PHP/version_php.png" alt="version de php instalada">
                <p>
                    Podemos hacer lo siguiente para ver si funciona correctamente. 
                    Ejecutamos el siguiente comando <strong>“sudo nano /var/www/html/info.php”</strong>. En el archivo que se nos abre escribimos lo siguiente. 
                </p>
                <img src="Recursos/PHP/prueba_php.png" alt="prueba para ver si funciona">
                <p>
                    Guardamos los cambios y buscamos en el navegador la <strong>IP:PUERTO e “info.php”</strong> al final.
                </p>
                <img src="Recursos/PHP/php_funciona.png" alt="pagina web de php" width="750">
            </div>
        </section>

        <!-- Securizar los diferentes servicios -->
        <!-- Securizando SSH -->          
        <h2>
            Es momento de asegurar el servidor.        
        </h2>
        <section id="securizar_ssh">
            <h3>
                Securizando SSH
            </h3>
            <div class="securizando_ssh">
                <p>
                    Debemos evitar que nuestro servidor sea una máquina de generar spam debemos hacerlo seguro.
                    Debemos securizar para que no haya problemas a futuro con hackers oportunistas que vean una brecha de seguridad 
                    y se cuelen en nuestro servidor.
                    Antes que nada, vamos a realizar una copia de seguridad del archivo de configuración del SSH para restaurarlo en el hipotético caso de que salga mal. 
                    Realizaremos la copia haciendo uso del comando <strong>“sudo cp /etc/ssh/sshd_config /etc/ssh/sshd_config.bak”</strong>.
                </p>
                <img src="Recursos/SECURIZAR%20SSH/copia_seguridad_ssh.png" alt="copia de seguridad archivo conf">
                <p>
                    Antes de editar el archivo, podemos revisar las opciones que están establecidas actualmente con el comando <strong>“sudo sshd -T”</strong>. 
                    Esto ejecutará el servidor OpenSSH en modo prueba ampliado, lo que validará el archivo de configuración completo e imprimirá los valores 
                    con configuración efectivos.
                </p>
                <p>
                    Hecha la copia de seguridad, vamos a configurar el archivo <strong>“sudo nano etc/ssh/sshd_config</strong>”.
                    Se nos abrirá el siguiente bloque de texto.
                </p>
                <img src="Recursos/SECURIZAR%20SSH/ssh_config_sin_tocar.png" alt="menu config sin alterar">
                <div class="permitroot_no">
                    <div class="img_permit">
                        <img src="Recursos/SECURIZAR%20SSH/permitrootlogin_no.png" alt="permit root login no">
                    </div>
                    <div class="texto_permit">
                        <p>
                            Primero, deshabilitamos el inicio de sesión a través del SSH como el usuario root estableciendo la siguiente opción:
                            <strong>“PermitRootLogin no”</strong>.
                        </p>
                    </div>
                </div>
                <p>
                    Esto evitará que un atacante inicie sesión directamente como usuario root. Además, alienta las buenas prácticas de seguridad operativas, 
                    como operar como usuario sin privilegios y usar “sudo” para escalar privilegios solo cuando sea necesario.
                </p>
                <p>
                    A continuación, podemos limitar el nº máximo de intentos de autenticación para una sesión de inicio de sesión configurando el apartado de 
                    <strong>MaxAuthTries</strong>. Para este ejercicio, lo limitaremos en 3 intentos.
                </p>
                <p>
                    Otra cosa que podemos hacer es cambiar el LoginGraceTime para que solo se tengan 20 segundos para conectarse. 
                    También, configuramos el número de dispositivos conectados de manera simultánea estableciendo este a 3, que es el número de integrantes del grupo, 
                    esto se hace cambiando la configuración de MaxSessions. La configuración se quedaría así:
                </p>
                <img src="Recursos/SECURIZAR%20SSH/opciones_varias.png" alt="opciones cambiadas">
                <p>
                    Pero no hemos acabado todavía. Estableceremos otro puerto que no sea el 22 (que es el número por defecto), por ejemplo, pondremos el puerto 42069.
                </p>
                <img src="Recursos/SECURIZAR%20SSH/ssh_puerto_42069.png" alt="puerto 42069">
                <p>
                    Para más seguridad, añadiremos al archivo <strong>sshd_config</strong> la siguiente línea. Esto sirve para configurar los algoritmos de intercambios de claves:
                    <strong>
                        “KexAlgorithms curve25519-sha256@libssh.org,ecdh-sha2-nistp521,ecdh-sha2-nistp384,ecdh-sha2-nistp256,diffie-hellman-group-exchange-sha256”
                    </strong> 
                </p>
                <p>
                    Ahora, vamos a desmarcar las siguientes líneas que nos aparecen en color azul:
                </p>
                <img src="Recursos/SECURIZAR%20SSH/Hotskey.png" alt="se cambio la configuracion hotskey">
                <p>
                    Esto crea nuevas claves rsa dsa.
                </p>
                <p>
                    Saldremos de la configuración del ssh guardando los cambios cometidos.
                    Continuamos securizando nuestro servidor SSH haciendo uso del comando:
                    <strong>“sudo ssh-keygen -f /etc/ssh/ssh_host_rsa_key -t rsa -b 4096”</strong>
                    Con este comando generamos una nueva clave RSA.
                </p>
                <img src="Recursos/SECURIZAR%20SSH/clave_rsa.png" alt="clave rsa">
                <p>
                    Seguiremos, ahora, generando nuevas claves <strong>ECDSA</strong> y <strong>ED25519</strong> tendremos que utilizar los siguientes comandos:
                    <strong>“ssh-keygen -f /etc/ssh/ssh_host_ecdsa_key -t ecdsa -b 521”</strong>
                </p>
                <img src="Recursos/SECURIZAR%20SSH/clave_ecdsa.png" alt="clave ecdsa">
                <p>
                    <strong>“ssh-keygen -f /etc/ssh/ssh_host_ed25519_key -t ed25519”</strong>
                </p>
                <img src="Recursos/SECURIZAR%20SSH/clave_ed25519.png" alt="clave ed25519">
                <p>
                    Existen, además, diferentes métodos de autenticación disponibles en el servidor. Existen dos métodos principalmente: usuario y contraseña 
                    y también claves criptográficas. No obstante, si queremos dotar al sistema de una seguridad adicional, podemos combinar estas autenticaciones 
                    con claves generadas por aplicaciones como Google Authenticator o Latch OTP.
                </p>
                <div class="contenedor_logos">
                    <div class="google_authenticator">
                        <img src="Recursos/LOGOS/logo_google_autheticator.png" alt="logo del google Authenticator" width="150">
                        <p>
                            Google Authenticator
                        </p>
                    </div>
                    <div class="latch_otp">
                        <img src="Recursos/LOGOS/latch_otp.png" alt="logo del latch otp" width="300" height="151">
                        <p>
                            Latch OTP
                        </p>
                    </div>
                </div>
            </div>
        </section>
        <!-- Securizando FTP -->
        <section id="securizar_ftp">
            <h3>
                Securizando FTP
            </h3>
            <div class="securizando_ftp">
                <p>
                    Es buena práctica hacer una <strong style="color: black;">copia de seguridad</strong> de la configuración original, por si acaso, no vaya a ser que 
                    tengamos una desgracia. Para ello, hacemos uso del comando <strong>“sudo cp /etc/vsftpd.conf /etc/vsftpd.conf.original”</strong>.
                </p>
                <img src="Recursos/SECURIZAR%20FTP/copia_seguridad_ftpconfig.png" alt="copia de seguridad conf ftp">
                <p>
                    Hecha la copia de seguridad, podemos proseguir con nuestra tarea. El siguiente paso es habilitar los puertos para el tráfico FTP desde el firewall. 
                    Primero debemos comprobar su estado haciendo uso del comando <strong>“sudo ufw status”</strong>. Aquí puede ocurrir una cosa y es que aparezca su
                    estatus como inactivo, para activarlo usamos el siguiente comando: <strong>“sudo ufw enable”</strong>.
                </p>
                <img src="Recursos/SECURIZAR%20FTP/ftp_inactive_active.png" alt="status ufw">
                <ul>
                    <li>“sudo ufw allow 20/tcp”</li>
                    <li>“sudo ufw allow 21/tcp"</li>
                    <li>“sudo ufw allow 22/tcp”</li>
                    <li>“sudo ufw allow 990/tcp”</li>
                    <li>“sudo ufw allow 42069/tcp” (nuestro puerto establecido)</li>
                    <li>“sudo ufw allow 40000:50000/tcp”</li>
                </ul>
                <p>
                    Si hacemos uso, otra vez, del comando <strong>“sudo ufw status”</strong> veremos como se han añadido los puertos.
                </p>
                <img src="Recursos/SECURIZAR%20FTP/sudo_ufw_status.png" alt="puertos habilitados">
                <p>
                    Ahora, procedemos a editar y configurar el archivo vsftpd.conf, para ello, hacemos uso del comando: 
                    <strong>“sudo nano /etc/vsftpd.conf”</strong>. Se nos abrirá el siguiente editor de texto.
                </p>
                <img src="Recursos/SECURIZAR%20FTP/vsftpd_conf.png" alt="ventana de configuracion ftp">
                <p>
                    Para habilitar la escritura, con las flechas de desplazamiento buscamos la línea 
                    <strong>“#write_enable=YES”</strong> y quitamos el signo <strong>#</strong>.
                </p>
                <img src="Recursos/SECURIZAR%20FTP/write_enable_YES.png" alt="write_enable=YES">
                <p>
                    También tenemos que asegurarnos que la línea <strong>“local_enable=YES”</strong> esté descomentado.
                </p>
                <img src="Recursos/SECURIZAR%20FTP/local_enable_YES.png" alt="local_enable=YES">
                <p>
                    Ahora, debemos comprobar que <strong>“chroot_local_user=YES”</strong> esté descomentado también. 
                </p>
                <img src="Recursos/SECURIZAR%20FTP/chroot_local_user_YES.png" alt="chroot_local_user=YES">
                <p>
                    Con los cambios realizados, apretamos CTRL O para guardar, Enter para aceptar y CTRL X para salir.
                </p>
                <p>
                    Reiniciamos con el comando <strong>“sudo systemctl restart vsftpd”</strong> y verificamos el estatus del FTP usando el comando 
                    <strong>“sudo systemctl status vsftpd”</strong>.
                </p>
                <img src="Recursos/SECURIZAR%20FTP/reinicio_ftp_y_status.png" alt="reinicio y status de ftp">
                <p>
                    Cuando habilitamos esta opción, los usuarios locales del servidor FTP se enjaulan en sus directorios de inicio, lo que significa que solo tendrán acceso 
                    y visibilidad a los archivos y directorios dentro de su propio directorio de inicio asignado. No podrán navegar por el sistema a su antojo. 
                    Esta configuración es muy útil para aumentar la seguridad y proteger los sistemas, pues evita que los usuarios locales accedan a partes sensibles del sistema
                    de archivos y reduce el riesgo de que realicen cambios no autorizados en otras áreas del sistema.
                </p>
                <p>
                    Ahora, configuraremos la seguridad del FTP generando un certificado de seguridad SSL. Para ello, debemos ejecutar la instrucción siguiente:
                    <strong>“sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/vsftpd.pem -out /etc/ssl/private/vsftpd.pem”</strong>
                </p>
                <p>
                    A continuación ingresamos los datos que nos solicitan:
                </p>
                <img src="Recursos/SECURIZAR%20FTP/sudo_openssl_req.png" alt="cifrado">
                <p>
                    Volvemos a abrir el archivo de configuración para realizar nuevos cambios en este. Nos iremos al final y comentaremos 
                    (poniendo # al principio) las siguientes dos líneas:
                </p>
                <img src="Recursos/SECURIZAR%20FTP/rsa_cert_rsa_private.png" alt="rsa cert y rsa private">
                <img src="Recursos/SECURIZAR%20FTP/se_comentan_rsacert_rsa_priv.png" alt="se comenta esas líneas">
                <p>
                    Una vez estas estén comentadas, agregamos las siguientes líneas:
                </p>
                <p>
                    <strong>“rsa_cert_file=/etc/ssl/private/vsftpd.pem”</strong>
                </p>
                <p>
                    <strong>“rsa_private_key_file=/etc/ssl/private/vsftpd.pem”</strong>
                </p>
                <p>
                    Y establecemos el valor de <strong>“ssl_enable”</strong> a <strong>“YES”</strong>. La configuración quedaría de la siguiente manera:
                </p>
                <img src="Recursos/SECURIZAR%20FTP/ssl_enable_YES.png" alt="ssl enable=YES">
                <p>
                    Ahora, para terminar nuestra configuración del servidor FTP, añadiremos debajo de eso, lo siguiente:
                </p>
                <ul>
                    <li>“allow_anon_ssl=NO”</li>
                    <li>“force_local_data_ssl=YES”</li>
                    <li>“force_local_logins_ssl=YES”</li>
                    <li>“ssl_tlsv1=YES”</li>
                    <li>“require_ssl_reuse=NO”</li>
                    <li>“ssl_ciphers=HIGH”</li>
                </ul>
                <img src="Recursos/SECURIZAR%20FTP/configuraciones_varias.png" alt="configuraciones varias">
                <p>
                    Guardamos los cambios y cerramos el editor de texto. Luego reiniciamos el servidor usando el comando 
                    <strong>“sudo systemctl restart vsftpd”</strong>.
                </p>
                <img src="Recursos/SECURIZAR%20FTP/reinicio_ftp.png" alt="comando de reinicio ftp">
                <p>
                    Luego volveremos a comprobar el estado del servidor FTP para ver si todo funciona correctamente y no hubo un fallo o un contratiempo no deseado.
                </p>
                <p>
                    ¿Qué hemos hecho? Estos comandos son opciones de configuración en un servidor FTP que utiliza TLS/SSL para cifrar las comunicaciones.
                </p>
                <p>
                    <strong>“allow_anon_ssl=NO”</strong> establece si permite o no el acceso anónimo.
                </p>
                <p>
                    <strong>“force_local_data_ssl=YES”</strong> con esta opción en YES, se requiere que las conexiones de datos también se realicen a través de SSL/TLS. 
                    Esto asegura que los datos transferidos entre el servidor FTP y el cliente estén cifrados.
                </p>
                <p>
                    <strong>“force_local_logins_ssl=YES”</strong> se obliga a que las conexiones de inicio de sesión (autenticación) también se realicen a través de SSL/TLS. 
                    Esto asegura que el proceso de inicio de sesión esté protegido y cifrado.
                </p>
                <p>
                    <strong>“ssl_tlsv1=YES”</strong> habilita el soporte para el protocolo de seguridad TLSv1. 
                    TLS (Transport Layer Security) es una versión más segura y actualizada del protocolo SSL.
                </p>
                <p>
                    <strong>“require_ssl_reuse=NO"</strong> esta opción determina si se requiere que los clientes reutilicen una conexión SSL/TLS existente. 
                    Con este establecido en NO, no se requiere reutilizar la conexión, lo que permite conexiones separadas para cada transferencia de datos.
                </p>
                <p>
                    <strong>“ssl_ciphers=HIGH”</strong> establece los cifrados SSL/TLS permitidos. En este caso, se configura para utilizar cifrados de seguridad “HIGH”, 
                    lo que implica el uso de cifrados fuertes y seguros.
                </p>
                <p>
                    Tras estos cambios, debemos comprobar que el servidor FTP sigue en funcionamiento y no nos lo hemos cargado. Debemos procurar que todo esté bien escrito y debidamente espaciado para evitar errores. 
                    Haciendo uso, otra vez, del comando para ver el status debemos ver la palabra <strong>“active (running)”</strong>.
                </p>
            </div>
        </section>
        <!-- Securizando Servidor Web Apache2 -->
        <section id="securizar_apache2">
            <h3>
                Securizando servidor web Apache
            </h3>
            <div class="securizando_apache2">
                <p>
                    Pese a que el Servidor Web Apache es seguro, podemos añadir protección extra: 
                </p>
                <p>
                    Lo que primero que haremos para blindar este servicio es desactivar los tokens; esta configuración (en el archivo puesto como <strong>"ServerTokens ProductOnly”</strong>) 
                    determina qué información se muestra en el encabezado de respuesta “Server” cuando el servidor Apache responde a las solicitudes HTTP.
                </p>
                <p style="color: red; text-align: center;">
                    ¡Procura hacer una copia de seguridad antes de realizar cualquier cambio en dicho archivo!
                </p>
                <img src="Recursos/SECURIZAR%20APACHE2/copia_seguridad_security.conf.png" alt="copia de seguridad del archivo configuracion de seguridad">
                <p>
                    Para cambiar esta configuración nos iremos al archivo security.conf en el directorio: 
                    <strong>“/etc/apache2/conf-available/security.conf”</strong> haciendo uso del comando <strong>“sudo nano”</strong> al principio de dicho directorio.
                </p>
                <p>
                    Y debemos añadir la siguiente línea en el apartado que habla de los tokens: <strong>“ServerTokens ProductOnly”</strong>.
                </p>
                <img src="Recursos/SECURIZAR%20APACHE2/ServerTokens_antes.png" alt="antes del cambio">
                <img src="Recursos/SECURIZAR%20APACHE2/ServerTokens_despues.png" alt="despues del cambio">
                <p>
                    Guardamos y salimos para reiniciar el servicio apache2 para que se efectúen dichos cambios.
                </p>
                <img src="Recursos/SECURIZAR%20APACHE2/apache2_restart.png" alt="restart del servicio apache2">
                <p>
                    Volvemos a verificar su estado para ver que no ha habido ningún error:
                </p>
                <img src="Recursos/SECURIZAR%20APACHE2/apache2_status.png" alt="status apache2">
                <p>
                    Lo siguiente que haremos será ir al archivo <strong>“apache2.conf”</strong> y no permitir que el servidor apache lea cualquier archivo .htaccess con 
                    <strong>“AllowOverride None”</strong>. Esto evitará que un posible atacante cuele un archivo malicioso en el tráfico del servidor.
                </p>
                <img src="Recursos/SECURIZAR%20APACHE2/AllowOverride_none.png" alt="AllowOverride none">
                <p>
                    En el mismo editor, al final de este, añadiremos la siguiente línea:
                    <strong>“RequestReadTimeout header=10-20,MinRate=500 body=20,MinRate=500”</strong>
                </p>
                <p>
                    Esto hará que el servidor web Apache cierre la conexión si el cliente tarda más de 10 segundos en enviar sus encabezados HTTP, o tarda más de 20 segundos a una velocidad de 500 bytes/s. 
                    sEste comando es muy beneficioso pues evitará ataques de denegación de servicio (DDoS).
                </p>
                <img src="Recursos/SECURIZAR%20APACHE2/RequestRead.png" alt="bloqueo DDoS">
                <p>
                    Para efectuar todos los cambios, guardamos y reiniciamos el servidor apache. Para comprobar que todo funciona, comprobamos el estado.
                </p>
                <img src="Recursos/SECURIZAR%20APACHE2/apache2_status_cambios.png" alt="status apache2">
                <p>
                    Por último, y no menos importante, vamos a añadir los certificados SSL/TLS con el siguiente comando 
                    <strong>“sudo a2enmod headers”</strong>.
                </p>
                <img src="Recursos/SECURIZAR%20APACHE2/a2enmod.png" alt="a2enmod">
                <p>
                    Ese mensaje quiere decir que ya estaban habilitados de antes y que ya no hace falta volver a hacerlo. En todo caso, y si no lo has habilitado con anterioridad, 
                    te solicitará reiniciar el servicio apache2 (<strong>“sudo systemctl restart apache2”</strong>) y se te habilitaran.
                </p>
            </div>
        </section>
    </body>
</html>